{
  "openapi": "3.1.0",
  "info":
    {
      "title": "Live Coupon API",
      "description": "선착순 쿠폰 발급 서비스 API. 이벤트·쿠폰 조회, 쿠폰 발급, 마이페이지 등 프론트엔드 연동용 문서입니다.",
      "contact": { "name": "Live Coupon Project" },
      "version": "1.0.0",
    },
  "servers":
    [
      {
        "url": "http://localhost:8080",
        "description": "Local development server",
      },
    ],
  "tags":
    [
      { "name": "Coupon", "description": "쿠폰 발급 API" },
      { "name": "Event", "description": "이벤트·쿠폰 목록 및 관리 API" },
      { "name": "Admin", "description": "관리자용 이벤트·쿠폰 초기화 API" },
      { "name": "User", "description": "마이페이지·유저 정보 API" },
    ],
  "paths":
    {
      "/events/{eventId}/initialize-coupons":
        {
          "post":
            {
              "tags": ["Event"],
              "summary": "쿠폰 재고 Redis 초기화",
              "description": "이벤트 오픈 시 해당 이벤트의 모든 쿠폰 초기 재고를 Redis에 저장합니다. DB의 coupon_total_count를 Redis에 세팅할 때 호출합니다.",
              "operationId": "initializeCouponStocks",
              "parameters": [],
              "responses":
                {
                  "204": { "description": "초기화 완료" },
                  "404":
                    {
                      "description": "이벤트 없음",
                      "content":
                        {
                          "*/*":
                            {
                              "schema":
                                {
                                  "$ref": "#/components/schemas/ErrorResponse",
                                },
                            },
                        },
                    },
                },
            },
        },
      "/coupons/{couponId}/issue":
        {
          "post":
            {
              "tags": ["Coupon"],
              "summary": "쿠폰 발급",
              "description": "선착순 쿠폰 발급. Rate limit은 유저 ID 및 클라이언트 IP 기준으로 적용됩니다. 로그인 필요.",
              "operationId": "issueCoupon",
              "parameters": [],
              "responses":
                {
                  "200": { "description": "발급 성공" },
                  "409":
                    {
                      "description": "재고 소진 / 중복 발급 / 이벤트 종료 등",
                      "content":
                        {
                          "*/*":
                            {
                              "schema":
                                {
                                  "$ref": "#/components/schemas/ErrorResponse",
                                },
                            },
                        },
                    },
                  "404":
                    {
                      "description": "쿠폰/이벤트 없음",
                      "content":
                        {
                          "*/*":
                            {
                              "schema":
                                {
                                  "$ref": "#/components/schemas/ErrorResponse",
                                },
                            },
                        },
                    },
                  "429":
                    {
                      "description": "요청 제한 초과 (Rate limit)",
                      "content":
                        {
                          "*/*":
                            {
                              "schema":
                                {
                                  "$ref": "#/components/schemas/ErrorResponse",
                                },
                            },
                        },
                    },
                },
            },
        },
      "/admin/{eventId}/initialize-coupons":
        {
          "post":
            {
              "tags": ["Admin"],
              "summary": "쿠폰 재고 Redis 초기화",
              "description": "이벤트 오픈 시 해당 이벤트의 모든 쿠폰 초기 재고를 Redis에 저장합니다. DB의 coupon_total_count를 Redis에 세팅할 때 호출합니다.",
              "operationId": "initializeCouponStocks_1",
              "parameters": [],
              "responses":
                {
                  "200": { "description": "초기화 완료" },
                  "404":
                    {
                      "description": "이벤트 없음",
                      "content":
                        {
                          "*/*":
                            {
                              "schema":
                                {
                                  "$ref": "#/components/schemas/ErrorResponse",
                                },
                            },
                        },
                    },
                },
            },
        },
      "/mypage":
        {
          "get":
            {
              "tags": ["User"],
              "summary": "마이페이지 유저 정보",
              "description": "로그인한 유저의 이름과 보유 쿠폰 목록·상태를 반환합니다. 로그인 필요.",
              "operationId": "getUserInfo",
              "responses":
                {
                  "200":
                    {
                      "description": "성공",
                      "content":
                        {
                          "*/*":
                            {
                              "schema":
                                { "$ref": "#/components/schemas/UserResponse" },
                            },
                        },
                    },
                  "404":
                    {
                      "description": "유저 없음",
                      "content":
                        {
                          "*/*":
                            {
                              "schema":
                                {
                                  "$ref": "#/components/schemas/ErrorResponse",
                                },
                            },
                        },
                    },
                },
            },
        },
      "/events":
        {
          "get":
            {
              "tags": ["Event"],
              "summary": "전체 이벤트 조회",
              "description": "등록된 이벤트 목록을 반환합니다. 로그인 필요.",
              "operationId": "getEvents",
              "responses":
                {
                  "200":
                    {
                      "description": "성공",
                      "content":
                        {
                          "*/*":
                            {
                              "schema":
                                {
                                  "type": "array",
                                  "items":
                                    {
                                      "$ref": "#/components/schemas/EventResponse",
                                    },
                                },
                            },
                        },
                    },
                },
            },
        },
      "/events/{eventId}":
        {
          "get":
            {
              "tags": ["Event"],
              "summary": "이벤트 상세 조회",
              "description": "이벤트 ID로 단일 이벤트 정보를 반환합니다.",
              "operationId": "getEventById",
              "parameters": [],
              "responses":
                {
                  "200":
                    {
                      "description": "성공",
                      "content":
                        {
                          "*/*":
                            {
                              "schema":
                                {
                                  "$ref": "#/components/schemas/EventResponse",
                                },
                            },
                        },
                    },
                  "404":
                    {
                      "description": "이벤트 없음",
                      "content":
                        {
                          "*/*":
                            {
                              "schema":
                                {
                                  "$ref": "#/components/schemas/ErrorResponse",
                                },
                            },
                        },
                    },
                },
            },
        },
      "/events/{eventId}/coupons":
        {
          "get":
            {
              "tags": ["Event"],
              "summary": "이벤트별 쿠폰 목록 조회",
              "description": "해당 이벤트에 속한 쿠폰 목록을 반환합니다.",
              "operationId": "getCouponsByEventId",
              "parameters": [],
              "responses":
                {
                  "200":
                    {
                      "description": "성공",
                      "content":
                        {
                          "*/*":
                            {
                              "schema":
                                {
                                  "type": "array",
                                  "items":
                                    {
                                      "$ref": "#/components/schemas/CouponResponse",
                                    },
                                },
                            },
                        },
                    },
                  "404":
                    {
                      "description": "이벤트 없음",
                      "content":
                        {
                          "*/*":
                            {
                              "schema":
                                {
                                  "$ref": "#/components/schemas/ErrorResponse",
                                },
                            },
                        },
                    },
                },
            },
        },
      "/admin":
        {
          "get":
            {
              "tags": ["Admin"],
              "summary": "관리자 이벤트 목록",
              "description": "관리자 페이지 진입 시 등록된 이벤트 목록을 반환합니다.",
              "operationId": "getEvents_1",
              "responses":
                {
                  "200":
                    {
                      "description": "성공",
                      "content":
                        {
                          "*/*":
                            {
                              "schema":
                                {
                                  "type": "array",
                                  "items":
                                    {
                                      "$ref": "#/components/schemas/EventResponse",
                                    },
                                },
                            },
                        },
                    },
                },
            },
        },
    },
  "components":
    {
      "schemas":
        {
          "ErrorResponse":
            {
              "type": "object",
              "properties":
                {
                  "errorCode": { "type": "string" },
                  "message": { "type": "string" },
                  "timestamp": { "type": "string", "format": "date-time" },
                  "path": { "type": "string" },
                },
            },
          "UserCouponItemResponse":
            {
              "type": "object",
              "properties":
                {
                  "userCouponId": { "type": "integer", "format": "int64" },
                  "couponId": { "type": "integer", "format": "int64" },
                  "couponName": { "type": "string" },
                  "couponStatus":
                    { "type": "string", "enum": ["NOT_USE", "USE", "END"] },
                },
            },
          "UserResponse":
            {
              "type": "object",
              "properties":
                {
                  "userId": { "type": "integer", "format": "int64" },
                  "userName": { "type": "string" },
                  "ownedCoupons":
                    {
                      "type": "array",
                      "items":
                        {
                          "$ref": "#/components/schemas/UserCouponItemResponse",
                        },
                    },
                },
            },
          "EventResponse":
            {
              "type": "object",
              "properties":
                {
                  "eventId": { "type": "integer", "format": "int64" },
                  "eventName": { "type": "string" },
                  "eventDetail": { "type": "string" },
                  "eventStartDatetime":
                    { "type": "string", "format": "date-time" },
                  "eventEndDatetime":
                    { "type": "string", "format": "date-time" },
                },
            },
          "CouponResponse":
            {
              "type": "object",
              "properties":
                {
                  "couponId": { "type": "integer", "format": "int64" },
                  "couponName": { "type": "string" },
                  "couponDetail": { "type": "string" },
                  "couponApplyStartDatetime":
                    { "type": "string", "format": "date-time" },
                  "couponApplyEndDatetime":
                    { "type": "string", "format": "date-time" },
                  "couponTotalCount": { "type": "integer", "format": "int32" },
                },
            },
        },
    },
}
